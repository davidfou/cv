name: Release
on:
  push:
    tags:
      - v*
jobs:
  setup:
    name: ğŸ›  Setup
    timeout-minutes: 10
    runs-on: ubuntu-latest
    steps:
      - name: â¬‡ï¸ Checkout repo
        uses: actions/checkout@v3

      - name: â” Setup node
        uses: actions/setup-node@v3
        with:
          node-version: 20.9.0

      - name: ğŸ“¥ Install deps
        run: npm ci

      - name: ğŸŒ Install Playwright browser
        run: npx playwright install --with-deps chromium

      - name: ğŸ”¨ Build
        run: npm run build

      - name: ğŸ— Generate PDF
        run: node ./scripts/make-pdf.mjs

      - name: ğŸš€ Create release
        uses: fnkr/github-action-ghr@v1
        env:
          GHR_PATH: dist/
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
